apiVersion: torq.io/v2alpha
kind: Workflow
id: 3a8a58f6-3d6f-48a1-8740-f57da71ccab3
name: SentinelOne Socrates Tooling
trigger:
  onDemandTrigger:
    parameterList:
      parameters:
        - name: action
          description: The name of the action to execute in this workflow
          required: true
          prettyName: action
          singleSelect:
            options:
              - scan
              - quarantine
              - fetch_file
              - help
            defaultValue: ""
playbook:
  steps:
    - switch:
        uuid: b0673499-ee56-4deb-803e-2f568095e6e3
        pretty_name: Switch
        cases:
          - id: ba4c506a-c4ce-4038-8c85-2e4787fd0abe
            pretty_name: Scan
            conditions:
              or:
                - and:
                    - lvalue: '{{ $.event.action }}'
                      operator: EQUALS
                      rvalue: scan
            steps:
              - name: us-docker.pkg.dev/stackpulse/public/slack/message/message:2.1.0
                id: send_message
                env:
                  MESSAGE_TEXT: Scanning a device
                  RECIPIENT: devnull
                envFrom:
                  integrationRef: wolken
                uuid: 9ea21193-c47c-4baf-a201-814938542d22
                pretty_name: Send Message
                options:
                  executor:
                    name: slack_message_message_v_2_1_0
                    env: {}
                    sync: true
                    disable: false
                manifestId: 111abb4b-15cf-5065-8775-2f2662132e88
                isPrivate: false
                mock_output:
                  enabled: false
                skip: false
                retry: {}
          - id: 2edde8de-83f6-421f-a9a6-aa3f100f8aae
            pretty_name: Help
            conditions:
              or:
                - and:
                    - lvalue: '{{ $.event.action }}'
                      operator: EQUALS
                      rvalue: help
            steps:
              - name: us-docker.pkg.dev/stackpulse/public/utils/output_utils/set-variable:2.2.0
                id: help
                env:
                  DATA_TYPE: string
                  VALUE_STRING: |-
                    This workflows provides 3 functions relevant to run automations on Sentinel One Endpoint product. Use the action parameter to choose between: 'quarantine', 'scan' or 'fetch_file' using the following descriptions:
                    Use 'quarantine' to auarantine/isolate a computer from the network.
                    Use 'scan' when you need to scan a computer for malware.
                    Use 'fecth_file' when you have the full path of a file and need to download a file from the remote endpoint computer.
                  VARIABLE_NAME: help
                uuid: 82a139bb-3ad2-482f-aa68-9c949f87644a
                pretty_name: Help
                options:
                  executor:
                    name: utils_infrastructure_v_1_22_0
                    env:
                      COMMAND: set_variable
                    sync: true
                    disable: false
                manifestId: e430703a-6b6f-5114-9368-5e3fc166edb7
                isPrivate: false
                mock_output:
                  enabled: false
                skip: false
                retry: {}
              - exit:
                  success: "true"
                  pretty_name: Exit
                  output: |-
                    {
                      "result": "{{ $.help.help }}"
                    }
                  uuid: 12572af3-f1a3-4a32-80ab-a223d03bef52
                  use_schema: true
        default:
          id: ca7b4117-36f2-456b-a636-1afca1b1b494
          steps: []
  output_schema: |-
    {
        "result": {
            "type": 8,
            "prettyName": "result",
            "description": ""
        }
    }
root: true
